@using Microsoft.AspNetCore.Components.Routing
@using MudBlazor

@inherits LayoutComponentBase

<MudPopoverProvider />

<MudLayout>

        <!-- Topbar -->
        <MudAppBar Elevation="1">

            <!-- Sidebar Toggle -->
            <MudIconButton id="main-layout-sidebar-toggle"
                           Icon="@Icons.Material.Filled.Menu"
                           Color="Color.Inherit"
                           Edge="Edge.Start"
                           OnClick="@OnToggleSidebarClicked" />

            <!-- Title and subtitle -->
            <MudText Typo="Typo.h6" Class="ms-2">
                @LayoutContext.AppTitle
            </MudText>

            @if (!string.IsNullOrWhiteSpace(LayoutContext.AppSubtitle))
            {
                <MudText Typo="Typo.subtitle2" Class="ms-2 text-muted">
                    @LayoutContext.AppSubtitle
                </MudText>
            }

            <MudSpacer />

            <!-- Theme Toggle -->
            <MudIconButton id="main-layout-theme-toggle"
                           Icon="@GetThemeIcon()"
                           Color="Color.Inherit"
                           OnClick="@OnThemeToggleClicked" />


            <!-- profile / profile menu -->
            <MudMenu AnchorOrigin="Origin.TopRight"
                     TransformOrigin="Origin.TopRight">

                <ActivatorContent>
                    <MudButton id="main-layout-profile-button"
                               Color="Color.Inherit"
                               StartIcon="@Icons.Material.Filled.AccountCircle">
                        @if (!string.IsNullOrWhiteSpace(LayoutContext.DisplayName))
                        {
                            @LayoutContext.DisplayName
                        }
                        else
                        {
                            @("unknown user")
                        }
                    </MudButton>
                </ActivatorContent>
                <ChildContent>
                    @foreach (var item in LayoutContext.ProfileMenuItems)
                    {
                        <MudMenuItem OnClick="@(() => OnProfileMenuItemClick(item))">
                            @if (!string.IsNullOrWhiteSpace(item.Icon))
                            {
                                <MudIcon Class="me-2">@item.Icon</MudIcon>
                            }
                            @item.Text
                        </MudMenuItem>
                    }
                </ChildContent>
            </MudMenu>

        </MudAppBar>

        <!-- Sidebar -->
        <MudDrawer Anchor="Anchor.Start"
                   Variant="DrawerVariant.Responsive"
                   Open="@LayoutContext.IsSidebarOpen"
                   Elevation="1">

            <MudNavMenu>
                    @foreach (var item in LayoutContext.NavbarItems.OrderBy(x => x.Order))
                    {
                        <MudNavLink Href="@item.Href"
                                    Icon="@item.Icon"
                                    Match="NavLinkMatch.All">
                            @item.Text
                        </MudNavLink>
                    }
            </MudNavMenu>

        </MudDrawer>

        <!-- Main Content + Footer -->
        <MudMainContent>

            <div class="main-layout-main-body">
                @Body
            </div>

            <footer class="rw-footer d-flex justify-content-between px-4 py-2">
                <div class="rw-footer-left">@LayoutContext.FooterLeft</div>
                <div class="rw-footer-center text-center flex-grow-1">@LayoutContext.FooterCenter</div>
                <div class="rw-footer-right text-end">@LayoutContext.FooterRight</div>
            </footer>

        </MudMainContent>

    </MudLayout>
